{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '44869216-4addd85d29d39c45ae242764b';\n\nexport async function getPicturesByQuery(imageName, page = 1) {\n  const params = {\n    key: API_KEY,\n    q: imageName,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: 15\n  };\n\n  try {\n    const response = await axios.get(BASE_URL, { params });\n    return response.data;\n  } catch (error) {\n    throw error;\n  }\n}\n\n\n\n\n// import { formInput, showLoader } from '../main';\n\n// export function getPicturesByQuery() {\n//   const query = formInput.value;\n//   console.log(query);\n//   const API_KEY = '44869216-4addd85d29d39c45ae242764b';\n//   return fetch(\n//     `https://pixabay.com/api/?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true`\n//   ).then(res => {\n    \n//     console.log(res);\n\n   \n//     if (!res.ok) {\n//       throw new Error(res.status); \n//     }\n\n   \n//     return res.json();\n//   });\n","export function showImages({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) {\n  return `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\"/>\n      </a>\n      <ul class=\"info\">\n        <li class=\"info-item\"> <b>Likes</b> ${likes} </li>\n        <li class=\"info-item\"> <b>Views</b> ${views} </li>\n        <li class=\"info-item\"> <b>Comments</b> ${comments} </li>\n        <li class=\"info-item\"> <b>Downloads</b> ${downloads} </li>\n      </ul>\n    </li>\n  `;\n}\n\nexport function imageTemplate(arr) {\n  return arr.map(showImages).join('');\n}\n\n\n\n// export function showImages(arr) {\n//   return images\n//     .map(\n//       ({\n//         webformatURL,\n//         largeImageURL,\n//         tags,\n//         likes,\n//         views,\n//         comments,\n//         downloads,\n//       }) => {\n//         `<li class=\"gallery-item\">\n//         <a class=\"gallery-link\"\n//         href=\"${largeImageURL}\"> \n//         <img class=\"gallery-image\"\n//         src=\"${webformatURL}\" \n//         alt=\"${tags}  \n//         width=\"360\" \n//         height=\"200\"\"/>\n//         </a>\n//         <ul class = \"gallery\">\n//           <li>\n//             <h3>likes</h3>\n//             <p>${likes}</p>\n//           </li>\n//           <li>\n//             <h3>views</h3>\n//             <p>${views}</p>\n//           </li>\n//           <li>\n//             <h3>comments</h3>\n//             <p>${comments}</p>\n//           </li>\n//           <li>\n//             <h3>downloads</h3>\n//             <p>${downloads}</p>\n//           </li>\n//         </ul>\n      \n//       </li>`;\n//       }\n//     )\n//     .join('');\n  \n// }","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { getPicturesByQuery  } from './js/pixabay-api.js';\nimport { imageTemplate } from './js/render-functions.js';\n\nconst searchForm = document.querySelector('.form');\nconst imageGallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.createElement('button');\nloadMoreBtn.textContent = 'Load more';\nloadMoreBtn.classList.add('load-more');\nimageGallery.parentNode.insertBefore(loadMoreBtn, imageGallery.nextSibling);\nloadMoreBtn.style.display = 'none';\nconst loaderContainer = document.createElement('div');\nloaderContainer.appendChild(loader);\nloadMoreBtn.parentNode.insertBefore(loaderContainer, loadMoreBtn.nextSibling);\n\nlet imageName = '';\nlet currentPage = 1;\nlet totalHits = 0;\n\nsearchForm.addEventListener('input', (event) => {\n  imageName = event.target.value.trim();\n});\n\nsearchForm.addEventListener('submit', onSubmit);\nloadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onSubmit(event) {\n  event.preventDefault();\n  currentPage = 1;\n  imageGallery.innerHTML = '';\n  loadMoreBtn.style.display = 'none';\n  showLoader();\n\n  if (!imageName) {\n    showInfoMessage('Please enter a search query!', 'blue');\n    hideLoader();\n    return;\n  }\n\n  try {\n    const data = await getPicturesByQuery (imageName, currentPage);\n    totalHits = data.totalHits;\n    if (data.hits.length === 0) {\n      showInfoMessage('Sorry, there are no images matching your search query. Please try again!', 'red');\n      return;\n    }\n\n    renderImages(data.hits);\n    lightbox.refresh();\n    checkLoadMoreVisibility();\n  } catch (error) {\n    showInfoMessage('An error occurred while fetching images. Please try again later.', 'orange');\n    console.error(error);\n  } finally {\n    hideLoader();\n  }\n\n  event.target.reset();\n}\n\nasync function onLoadMore() {\n  currentPage += 1;\n  showLoader();\n\n  try {\n    const data = await getPicturesByQuery (imageName, currentPage);\n    renderImages(data.hits);\n    lightbox.refresh();\n    scrollPage();\n    checkLoadMoreVisibility();\n  } catch (error) {\n    showInfoMessage('An error occurred while fetching images. Please try again later.', 'orange');\n    console.error(error);\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction renderImages(images) {\n  const markup = imageTemplate(images);\n  imageGallery.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction checkLoadMoreVisibility() {\n  if (currentPage * 15 >= totalHits) {\n    loadMoreBtn.style.display = 'none';\n    showInfoMessage(\"We're sorry, but you've reached the end of search results.\", 'blue');\n  } else {\n    loadMoreBtn.style.display = 'block';\n  }\n}\n\nfunction scrollPage() {\n  const { height } = document.querySelector('.gallery-item').getBoundingClientRect();\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction showLoader() {\n  loader.style.display = 'inline-block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n\nfunction showInfoMessage(message, bgColor) {\n  iziToast.info({\n    position: 'topRight',\n    timeout: 1800,\n    maxWidth: 300,\n    icon: 'none',\n    message: message,\n    backgroundColor: bgColor,\n  });\n}\n\n\nlet lightbox = new SimpleLightbox(\".gallery a\", { captionDelay: 250, captionsData: \"alt\" });\n\n\n// import iziToast from 'izitoast';\n// import 'izitoast/dist/css/iziToast.min.css';\n// import { getPicturesByQuery } from './js/pixabay-api';\n// import { showImages } from './js/render-functions';\n// import SimpleLightbox from 'simplelightbox';\n// import 'simplelightbox/dist/simple-lightbox.min.css';\n\n// const searchForm = document.querySelector('.form');\n// const gallery = document.querySelector('.gallery');\n// const preloader = document.querySelector('.loader-wrap');\n// const loadMoreBtn = document.querySelector('.load-more-btn');\n\n// const lightbox = new SimpleLightbox('.gallery a', {\n//   captionsData: 'alt',\n//   captionDelay: 250,\n// });\n\n// const params = {\n//   query: '',\n//   page: 1,\n//   per_page: 15,\n//   max_page: 0,\n// };\n\n// searchForm.addEventListener('submit', handlerSubmit);\n\n// async function handlerSubmit(event) {\n//   event.preventDefault();\n//   gallery.innerHTML = '';\n//   params.page = 1;\n//   params.query = searchForm.elements.input.value.trim();\n//   loadMoreBtn.style.display = 'none';\n//   loadMoreBtn.removeEventListener('click', handlerLoadMore);\n\n//   if (!params.query) {\n//     iziToast.warning({\n//       title: 'Caution',\n//       titleColor: 'white',\n//       titleSize: '16px',\n//       message: 'Please, fill out the field!',\n//       messageColor: 'white',\n//       messageSize: '16px',\n//       position: 'topRight',\n//       backgroundColor: 'rgba(255, 160, 0, 0.6)',\n//       close: false,\n//       closeOnClick: true,\n//     });\n//     searchForm.reset();\n//     return;\n//   }\n\n//   preloader.style.display = 'flex';\n//   try {\n//     const picture = await getPicturesByQuery(params);\n    \n//     if (picture.hits.length === 0) {\n//       iziToast.error({\n//         title: 'Error',\n//         titleColor: 'white',\n//         titleSize: '16px',\n//         message: 'Sorry, there are no images matching your search query. Please try again!',\n//         messageColor: 'white',\n//         messageSize: '16px',\n//         position: 'bottomRight',\n//         backgroundColor: 'rgba(239, 64, 64, 0.6)',\n//         close: false,\n//         closeOnClick: true,\n//       });\n//     } else {\n//       params.max_page = Math.ceil(picture.totalHits / params.per_page);\n      \n//       if (params.max_page > 1) {\n//         loadMoreBtn.style.display = 'block';\n//         loadMoreBtn.addEventListener('click', handlerLoadMore);\n//       } else {\n//         loadMoreBtn.style.display = 'none';\n//         iziToast.warning({\n//           title: 'Caution',\n//           titleColor: 'white',\n//           titleSize: '16px',\n//           message: 'We are sorry, but you have reached the end of search results.',\n//           messageColor: 'white',\n//           messageSize: '16px',\n//           position: 'bottomCenter',\n//           backgroundColor: 'rgba(70, 130, 180, 0.8)',\n//           close: false,\n//           closeOnClick: true,\n//           timeout: 6000,\n//         });\n//       }\n      \n//       gallery.innerHTML = showImages(picture.hits);\n//       lightbox.refresh();\n//     }\n//   } catch (error) {\n//     iziToast.error({\n//       title: 'Error',\n//       titleColor: 'white',\n//       titleSize: '16px',\n//       message: `Ups... Something went wrong. Error: ${error}`,\n//       messageColor: 'white',\n//       messageSize: '16px',\n//       position: 'bottomRight',\n//       backgroundColor: 'rgba(239, 64, 64, 0.6)',\n//       close: false,\n//       closeOnClick: true,\n//     });\n//   } finally {\n//     searchForm.reset();\n//     preloader.style.display = 'none';\n//   }\n// }\n\n// async function handlerLoadMore() {\n//   params.page += 1;\n//   preloader.style.display = 'flex';\n//   loadMoreBtn.style.display = 'none';\n  \n//   try {\n//     const picture = await getPicturesByQuery(params);\n//     gallery.insertAdjacentHTML('beforeend', showImages(picture.hits));\n//     lightbox.refresh();\n\n//     window.scrollBy({\n//       top: gallery.lastElementChild.clientHeight * 2,\n//       behavior: 'smooth',\n//     });\n//   } catch (error) {\n//     iziToast.error({\n//       title: 'Error',\n//       titleColor: 'white',\n//       titleSize: '16px',\n//       message: `Ups... Something went wrong. Error: ${error}`,\n//       messageColor: 'white',\n//       messageSize: '16px',\n//       position: 'bottomRight',\n//       backgroundColor: 'rgba(239, 64, 64, 0.6)',\n//       close: false,\n//       closeOnClick: true,\n//     });\n//   } finally {\n//     preloader.style.display = 'none';\n    \n//     if (params.page === params.max_page) {\n//       loadMoreBtn.style.display = 'none';\n//       loadMoreBtn.removeEventListener('click', handlerLoadMore);\n      \n//       iziToast.warning({\n//         title: 'Caution',\n//         titleColor: 'white',\n//         titleSize: '16px',\n//         message: 'We are sorry, but you have reached the end of search results.',\n//         messageColor: 'white',\n//         messageSize: '16px',\n//         position: 'bottomCenter',\n//         backgroundColor: 'rgba(70, 130, 180, 0.8)',\n//         close: false,\n//         closeOnClick: true,\n//         timeout: 6000,\n//       });\n//     } else {\n//       loadMoreBtn.style.display = 'block';\n//     }\n//   }\n// }\n"],"names":["BASE_URL","API_KEY","getPicturesByQuery","imageName","page","params","axios","error","showImages","webformatURL","largeImageURL","tags","likes","views","comments","downloads","imageTemplate","arr","searchForm","imageGallery","loader","loadMoreBtn","loaderContainer","currentPage","totalHits","event","onSubmit","onLoadMore","showLoader","showInfoMessage","hideLoader","data","renderImages","lightbox","checkLoadMoreVisibility","scrollPage","images","markup","height","message","bgColor","iziToast","SimpleLightbox"],"mappings":"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"}